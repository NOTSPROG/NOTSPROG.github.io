<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>NX の 博客</title><meta name="author" content="Nick Xu"><meta name="copyright" content="Nick Xu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="这家伙真勤奋，什么都留下了">
<meta property="og:type" content="website">
<meta property="og:title" content="NX の 博客">
<meta property="og:url" content="https://www.nickxu.top/page/5/index.html">
<meta property="og:site_name" content="NX の 博客">
<meta property="og:description" content="这家伙真勤奋，什么都留下了">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.nickxu.top/static/favicon.jpg">
<meta property="article:author" content="Nick Xu">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.nickxu.top/static/favicon.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.nickxu.top/page/5/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/pluginsSrc/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: '/pluginsSrc/flickr-justified-gallery/dist/fjGallery.min.js',
      css: '/pluginsSrc/flickr-justified-gallery/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'NX の 博客',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-03-06 10:01:48'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/static/my.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="NX の 博客" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="NX の 博客" type="application/rss+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/static/favicon.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">259</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">53</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">36</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/todo/"><i class="fa-fw fas fa-list-alt"></i><span> ToDo</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-coffee"></i><span> 更多</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/contact/"><i class="fa-fw fas fa-comments"></i><span> 留言板</span></a></li><li><a class="site-page child" href="/bookmarks/"><i class="fa-fw fas fa-bookmark"></i><span> 网址收藏</span></a></li><li><a class="site-page child" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/static/202202230023824.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">NX の 博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/todo/"><i class="fa-fw fas fa-list-alt"></i><span> ToDo</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-coffee"></i><span> 更多</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/contact/"><i class="fa-fw fas fa-comments"></i><span> 留言板</span></a></li><li><a class="site-page child" href="/bookmarks/"><i class="fa-fw fas fa-bookmark"></i><span> 网址收藏</span></a></li><li><a class="site-page child" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">NX の 博客</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="tencent://message/?uin=976180942&amp;Site=tool.520101.com&amp;Menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="/static/weixin.jpg" target="_blank" title="微信"><i class="fab fa-weixin"></i></a><a class="social-icon" href="mailto:976180942@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/rss2.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/16/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL17%EF%BC%9A%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-K8S-%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%92%8C%E8%B0%83%E5%BA%A6/" title="『字节青训营-4th-大数据』L17：深入理解 K8S 资源管理和调度">『字节青训营-4th-大数据』L17：深入理解 K8S 资源管理和调度</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-16T13:46:48.000Z" title="发表于 2022-08-16 21:46:48">2022-08-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料六】第四届字节跳动青训营 - 掘金





Kubernetes 简介
为什么要 k8s

k8s 是什么

k8s 核心概念


Pod


spec：pod的核心配置，可以配置多个 containers

Volume/PV/PVC/StrorageClass

Volume 太老了直接跳过
Deployment

template 就是一个 pod 的声明
StatefulSet

Node

k8s 设计准则


声明式而不是命令式：告诉 k8s 最终想要什么状态，而不是具体要做什么做什么
控制循环：怎么生成中间步骤呢？通过控制循环
简单
模块化
向下兼容
开放

k8s 架构


k8s 核心通信机制 List-Watch

这里老师讲得真的很清楚，而且认为这个机制是 k8s 最大的特色
k8s 核心功能

资源管理

资源上报

节点资源样例

资源分配


状态维护

资源回收


调度
资源申请


request和limits：底线和上限

调度流程


示例

MySQL

WordPress



优化实践
k8s  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/14/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL16%EF%BC%9A%E8%B5%B0%E8%BF%9B-Yarn-%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%92%8C%E8%B0%83%E5%BA%A6/" title="『字节青训营-4th-大数据』L16：走进 Yarn 资源管理和调度">『字节青训营-4th-大数据』L16：走进 Yarn 资源管理和调度</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-14T13:46:34.000Z" title="发表于 2022-08-14 21:46:34">2022-08-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料六】第四届字节跳动青训营 - 掘金




YARN 概述
初识调度系统
场景导入

一种简易分配模型

优化的分配模型


调度系统演进
调度系统发展的背景

调度系统解决的问题

调度系统预达的目标

调度系统模型

主要是前两者用的比较多
YARN 设计思想
演化背景

离线生态

面临挑战

YARN 整体架构
系统架构

任务运行生命周期核心流程

这里视频里讲得很清楚
Client 把任务提交到 Resource Manager，然后 RM 会拉起 AM
AM 再用心跳交互资源的申请和分配，再去拉起对应的节点
运行中，AM 会监控，运行结束后 AM  会向 RM 注销
核心模块

Resource Manager
整体架构

主要职责

状态机管理
RMApp 状态机

RMAppAttempt

RMContainer

RMNode

调度器分析
任务/资源组织

调度流程

典型调度器

Node Manager
整体架构

主要职责

状态机管理
Application

Container

LocalizedReso ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/13/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL15%EF%BC%9A%E6%B5%85%E8%B0%88%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%80%E8%87%B4%E6%80%A7%E5%8D%8F%E8%AE%AE/" title="『字节青训营-4th-大数据』L15：浅谈分布式一致性协议">『字节青训营-4th-大数据』L15：浅谈分布式一致性协议</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-13T13:46:24.000Z" title="发表于 2022-08-13 21:46:24">2022-08-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料六】第四届字节跳动青训营 - 掘金



分布式系统
分布式系统面临的挑战

理想中的分布式系统

从 HDFS 开始

案例 - KV


小结

一致性与共识算法
从复制开始


最好不要都接受请求，应设置一个主一个从
如何复制

两种策略，但是第一种的代价太高了

关于读操作

什么是一致性


复制协议
当失效发生

小结

共识算法



小结

从 Raft 入手
Paxos

Raft

复制状态机（RSM）

Raft 角色



客户端向 s2 发送请求
s2 把请求转成 log ，然后发送给 follower
多数完成，就回复客户




旧 leader 无响应后，发现的节点发起投票，获得半数投票即成为新 leader
Raft 日志复制

小箭头：确认已经提交了的 log
Raft 从节点失效

没有真正对比 log 的内容，只需要对比 term 和 index
Raft Term

Raft 主节点失效

Raft Leader failure

格子上面的数字是几号 term
为什么第一个状态 s1 的 term ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/12/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL14%EF%BC%9ALSMT-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E6%B5%85%E6%9E%90/" title="『字节青训营-4th-大数据』L14：LSMT 存储引擎浅析">『字节青训营-4th-大数据』L14：LSMT 存储引擎浅析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-12T13:46:11.000Z" title="发表于 2022-08-12 21:46:11">2022-08-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：juejin.cn




LSMT 与存储引擎介绍
LSMT 的历史

LSMT 是什么

存储引擎是什么



LSMT 存储引擎的优势与实现
LSMT 与 B+ Tree 的异同

但 LSMT 是追加写，然后后台择机合并

二者在逻辑上实际是等价的
为什么要采用 LSMT 模型？




LSMT 存储引擎的实现

Write





Snapshot &amp; Supervision




Get &amp; BloomFilter

又是熟悉的 BloomFilter（
Compact


用读放大的增加换取写放大的减小
LSMT 模型理论分析
云原生的 LSMT 存储引擎 - HBase

LSMT 模型算法复杂度分析

Level


这个失效率的推导非常复杂
Tier


思考题

这里建议看原视频，鄙人一直在听天书（
总结

LSMT 存储引擎调优案例与展望
TerarkDB

TerarkDB&amp; Abase &amp; ByteGraph

Flink

新硬件

新模型

新参数 / 新工况

这个是最复杂的
总结

</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/10/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL13%EF%BC%9AParquet-%E4%B8%8E-ORC%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD%E5%88%97%E5%BC%8F%E5%AD%98%E5%82%A8/" title="『字节青训营-4th-大数据』L13：Parquet 与 ORC：高性能列式存储">『字节青训营-4th-大数据』L13：Parquet 与 ORC：高性能列式存储</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-10T13:46:00.000Z" title="发表于 2022-08-10 21:46:00">2022-08-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料五】第四届字节跳动青训营 - 掘金








列存 vs 行存
数据格式层概述

分层视角下的数据形态

两种数据查询分析场景：OLTP vs OLAP

OLTP：行式存储格式

OLAP：列式存储格式

总结

Parquet 原理解释
Parquet 简介

Parquet in Action
DDL

Spark


Parquet vs Text Format

做了压缩，而且性能反而还会有提升

Dremel 数据模型


数据布局

编码 Encoding

列基数不大：去重后的数据不多

压缩 Compression


索引 Index


这东西在第一节课也出现了
排序 Ordering

过滤下推 Predicate PushDown

Spark 集成 - 向量化读

深入 Dremel 数据模型

老师说听不懂没关系，哈哈哈


小结

ORC 详解和对比
ORC 简介

数据模型


数据布局

ACID 特性简介

AliORC

索引增强

小列聚合

异步读取

思考

Parquet vs ORC
 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/09/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL12%EF%BC%9A%E4%BB%8E-Kafka-%E5%88%B0-Pulsar%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%B5%81%E6%BC%94%E8%BF%9B%E4%B9%8B%E8%B7%AF/" title="『字节青训营-4th-大数据』L12：从 Kafka 到 Pulsar：数据流演进之路">『字节青训营-4th-大数据』L12：从 Kafka 到 Pulsar：数据流演进之路</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-09T13:45:47.000Z" title="发表于 2022-08-09 21:45:47">2022-08-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料四】第四届字节跳动青训营 - 掘金



消息队列概述
消息队列的应用场景

上下游解耦
MQ 消息通道

Eventbridge 数据总线

Data Platform 流数据平台

主流消息队列的相关介绍

Kafka 详解
架构介绍

Zookeeper

Broker

Controller
选举

作用

Coordinator

高可用

副本 ISR 机制

写入 ACK 机制

如何保证消息不丢

ACK = -1 并且 最少 ISR = 2

先看左下角，只有一个 leader 而没有 follwer 的情况，然后再看上面
结合右侧概念解释理解

第一个策略更注重一致性
第二个更注重可用性
集群扩缩容

扩容步骤

扩缩容问题

未来演进之路



运维/调优经验介绍

单机吞吐

in_sync_replica 看业务重要性，2或3
集群参数配置

扩缩容优化

指标可视化

Pulsar 详解
Pulsar 架构介绍

Pulsar Proxy

非必须，但是作用很大
Pulsar Broker

Pulsar Sto ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/07/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL11%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%B9%96%E4%B8%89%E5%89%91%E5%AE%A2%EF%BC%9ADelta-Lake%E3%80%81Hudi-%E4%B8%8E-Iceberg-%E8%AF%A6%E8%A7%A3/" title="『字节青训营-4th-大数据』L11：数据湖三剑客：Delta Lake、Hudi 与 Iceberg 详解">『字节青训营-4th-大数据』L11：数据湖三剑客：Delta Lake、Hudi 与 Iceberg 详解</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-07T13:45:31.000Z" title="发表于 2022-08-07 21:45:31">2022-08-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料四】第四届字节跳动青训营 - 掘金




发展历史
数据湖发展阶段1 - Hadoop


数据湖发展阶段2 - Hive


数据湖发展阶段3 - 湖仓一体

存储计算不分离、结构化数据


业界三大数据湖



关于“数据湖”

核心技术
文件结构


Time travel



Transaction



原子性

事务隔离

Schema Evolution




各有所长
Iceberg

Well-designed Metadata Layer

s1 比 s0 多的就是最右边的一个 manifest file，而对应的就是最右边的 data files
Data File Filter

Hidden Partition

Hudi

Timeline Service &amp; Upsert &amp; Incremental

这里建议看原视频，讲的还是很清楚的
Copy On Write

更新的时候把所有列读到内存，改完再塞回去
Merge On Read

更新的时候把变动放到旁边，然后读的时候再合并
Del ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/06/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL10%EF%BC%9A%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA-HBase-%E5%AE%9E%E6%88%98/" title="『字节青训营-4th-大数据』L10：深入浅出 HBase 实战">『字节青训营-4th-大数据』L10：深入浅出 HBase 实战</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-06T05:16:19.000Z" title="发表于 2022-08-06 13:16:19">2022-08-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料四】第四届字节跳动青训营 - 掘金https://juejin.cn/post/7124948585614934029#heading-0)


HBase 适用场景
什么是 HBase

HBase 和关系型数据库的区别

HBase 数据模型



这种类 JSON 的格式看上去也是很清晰的

使用场景

典型应用

半结构化 / 字典序有序索引的数据

“近在线” 海量分布式 KV / 宽表存储


写密集的高吞吐场景

HBase 数据模型的优缺点

架构设计
HBase 架构设计

HMaster 主要职责


RegionServer 主要职责


ZooKeeper 主要职责

ThriftServer 主要职责

大数据支撑
HBase 在大数据生态的定位

水平扩展能力

Region 热点切分

切分点选取




切分过程




流量设计

Region 碎片整合

流程设计

Region 负载均衡

调度策略

其他策略

故障恢复机制
HMaster



RegionServer


Distributed  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/05/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL9%EF%BC%9AHDFS-%E9%AB%98%E5%8F%AF%E7%94%A8%E5%92%8C%E9%AB%98%E6%89%A9%E5%B1%95%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/" title="『字节青训营-4th-大数据』L9：HDFS 高可用和高扩展机制分析">『字节青训营-4th-大数据』L9：HDFS 高可用和高扩展机制分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-05T08:14:20.000Z" title="发表于 2022-08-05 16:14:20">2022-08-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料三】第四届字节跳动青训营 - 掘金

元数据高可用
高可用的需求
服务高可用的需求

高可用的衡量

故障度量的指标

MTTR（Mean Time To Repair）：平均修复时间，系统能多快恢复。
MTTF（Mean Time To Failure）：平均失效时间，运行到故障间的时间，一般用于不可修复的系统（制造业）
MTBF（Mean Time Between Failures）：平均无故障时间，两次故障间的间隔，一般用于可修复的系统（软件）

可用性的年化

高可用的形式

HDFS 主备同步实现
HDFS NameNode 高可用架构

理论基础 - 状态机复制和日志

NameNode 操作日志的生产消费

NameNode 块状态维护

HDFS 自动主备切换
分布式协调组件 - ZooKeeper

自动主备切换流程 - Server 侧

脑裂问题：多个节点都认为自己是 active，都会去写日志
Fence 机制：会阻止多个节点同时写日志
自动主备切换流程 - Client 侧

过去，只存一个 ND 的地址，但现在会 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/03/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL8%EF%BC%9AHDFS-%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/" title="『字节青训营-4th-大数据』L8：HDFS 原理与应用">『字节青训营-4th-大数据』L8：HDFS 原理与应用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-03T05:00:28.000Z" title="发表于 2022-08-03 13:00:28">2022-08-03</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料三】第四届字节跳动青训营 - 掘金

HDFS 基本介绍


HDFS: Hadoop Distribute File System，是 Hadoop 的一个组件

Windows 单机文件系统

Linux 单机文件系统

分布式文件系统

分布式存储系统

HDFS 功能特性

演示环境

前面两个组件是为了高可用的，本节课主要放在 NameNode 和 DataNode 上


（一个演示视频）
架构原理
HDFS 组件

Client 写流程

Client 读流程

元数据节点 NameNode

知道 NameNode 很重要就可以了（
数据节点 DataNode

关键设计

NameNode 目录树维护

思考题：为什么不直接在硬盘上修改 fsimage ？
NameNode 数据放置


（一个关于 block 的演示视频）
DataNode

后面两个绿框里面的编号是通过哈希算出来的
HDFS 写异常处理
Lease Recovery

租约（Lease）就是一个锁
Pipeline Recovery

这是非常复杂的一 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/02/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL7%EF%BC%9APresto-%E6%9E%B6%E6%9E%84%E5%8E%9F%E7%90%86%E4%B8%8E%E4%BC%98%E5%8C%96%E4%BB%8B%E7%BB%8D/" title="『字节青训营-4th-大数据』L7：Presto 架构原理与优化介绍">『字节青训营-4th-大数据』L7：Presto 架构原理与优化介绍</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-02T05:00:08.000Z" title="发表于 2022-08-02 13:00:08">2022-08-02</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料三】第四届字节跳动青训营 - 掘金

概述
大数据与 OLAP 的演进


廉价机器：可以做到成本与性能的线性增长
存算分离：存储节点和计算节点可以不在一台物理机上



预计算：用空间换时间
Presto 设计思想


小结

Presto 架构原理与优化介绍
基础概念介绍
服务相关


黄色：数据源
绿色（深和浅）：服务
蓝色：用户

数据源相关

Query 相关


数据传输相关


核心组件架构介绍

服务发现

通信协议




代表了我想要关闭（当前手上还有东西，设置为此状态时，不会再安排新 task ，设定一个超时时间，过后关闭）
小结

Presto 重要机制
多租户资源管理
Case 介绍

Resource Group



（这里在解读代码）
多租户下的任务调度
物理计划生成


Stage 调度



Task 调度



实际使用中 90% 都是第3种
Split 调度


内存计算

Pipeline 化数据处理

反压机制

多数据源联邦查询


小结

性能优化实战
常用性能分析工具




阿里巴巴开源的 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/31/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL6%EF%BC%9A%E5%A4%A7%E6%95%B0%E6%8D%AE-Shuffle-%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/" title="『字节青训营-4th-大数据』L6：大数据 Shuffle 原理与实践">『字节青训营-4th-大数据』L6：大数据 Shuffle 原理与实践</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-07-31T04:59:26.000Z" title="发表于 2022-07-31 12:59:26">2022-07-31</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料二】第四届字节跳动青训营

讲真，这节课大概都听不懂（

Shuffle 概述
MapReduce 概述

Map

三张 gif
Shuffle

本质：通过哈希区别不同类型数据
Reduce

为什么 Shuffle 对性能非常重要

总结

批式计算的发展流程
Shuffle 算子
算子分类与应用


这个例子中，把一个 txt 按行分割，然后统计每个单词的个数
reduceByKey 产生 Shuffle，做的是 A + B 的操作（有很多机器）
最后 collect，返回结果
Spark 中对 Shuffle 的抽象 - 宽依赖、窄依赖


Shuffle Dependency



Shuffle 过程

Hash Shuffle
写数据

写数据优化

把每个 Partition 映射到某个文件的片段
Sort Shuffle
写数据

每个 task 只用一个文件存储真实数据
读数据

Shuffle 过程的触发流程

前 5 行只是记录计算过程，在 Collect 的时候才会进行计算
Shuffle Handle 的创建
 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/30/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL5%EF%BC%9ASpark-%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/" title="『字节青训营-4th-大数据』L5：Spark 原理与实践">『字节青训营-4th-大数据』L5：Spark 原理与实践</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-07-30T04:57:42.000Z" title="发表于 2022-07-30 12:57:42">2022-07-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料二】第四届字节跳动青训营

大数据处理引擎 Spark
大数据处理技术栈

常见大数据处理链路

开源大数据处理引擎

什么是 Spark？

用于大规模数据处理的统一分析引擎
Spark 版本演进

Spark 生态 &amp; 特点

Spark 特点
多语言支持

丰富数据源

丰富的 API/算子

Spark 运行架构

Spark 下载编译

Spark 包概览

Spark 提交命令

提交一个简单任务

Spark UI

Spark 性能 benchmark

SparkCore 原理解析
SparkCore

什么是 RDD

一个容错的可以并行执行的分布式处理集
如何创建 RDD

RDD 算子

RDD 依赖


RDD 执行流程

调度器

内存管理

多任务间内存分配

Shuffle

SortShuffleManager

External Shuffle Service

SparkSQL 原理解析

这里就是第一节课的内容了
Catalyst 优化器

RBO

语法树遍历-&gt;模式匹配-&gt;等价 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/29/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL4%EF%BC%9A%E6%B5%81%E8%AE%A1%E7%AE%97%E4%B8%AD%E7%9A%84-Window-%E8%AE%A1%E7%AE%97/" title="『字节青训营-4th-大数据』L4：流计算中的 Window 计算">『字节青训营-4th-大数据』L4：流计算中的 Window 计算</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-07-29T14:04:54.000Z" title="发表于 2022-07-29 22:04:54">2022-07-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料二】第四届字节跳动青训营https://juejin.cn/post/7122754431371706404#heading-36)



概述
流式计算 VS 批式计算

资源模型：批式跑完资源就释放了，流式是必须一直都占用的
批处理

T+1：加 1 天

处理时间窗口

处理时间 VS 时间时间

事件事件窗口

有些数据会有延迟
Watermark

小结

（感觉有点没听懂😂）
Watermark
什么是 Watermark

如何产生 Watermark

如何传递 Watermark

每个算子根据上游输入的最小值
如何通过 Flink UI 观察 Watermark

典型问题一

典型问题二

部分的分区断流（故障、晚上业务少等）的问题
典型问题三

Window
Window 分类

Window 使用

滚动窗口

滑动窗口

会话窗口

迟到数据


增量 VS 全量计算

EMIT 触发

小结

优化机制
Mini-batch 优化


让算子攒一小批，然后再处理，避免高频读写
但是这样也会增加延迟，所以实际上 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/27/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL3%EF%BC%9AExactly-Once-%E8%AF%AD%E4%B9%89%E5%9C%A8-Flink-%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0/" title="『字节青训营-4th』L3：Exactly Once 语义在 Flink 中的实现">『字节青训营-4th』L3：Exactly Once 语义在 Flink 中的实现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-07-27T09:39:39.000Z" title="发表于 2022-07-27 17:39:39">2022-07-27</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料一】第四届字节跳动青训营 - 掘金



数据流和动态表
随处可见的流式数据

传统 SQL 和流处理

数据流和动态图转换

先转换为动态表，再执行 SQL，再转为流

连续查询

查询产生仅追加数据的动态表

两个连续查询对比

Retract 消息的产生

对之前的结果进行回撤
状态

数据流和动态表转换回顾

不同数据处理保证的语义

Exactly-Once 和 Checkpoint
状态快照与恢复

一个源源不断的数字流，分布对奇数和偶数进行累加和
现在要备份，需要记录现在消费的位点（Source 算子）与目前的和（两个 sum 算子）
保存这 3 个状态，发生故障后就可以通过最近的保存点恢复
制作快照的时间点

不能在任意时间点保存，必须等待下游数据全部处理完成
因为恢复时上游不会重复下发数据，而下游可能在快照时还没处理或收到
可见这种方法需要停止业务消费，有没有更好的方法？
Chandy - Lamport 算法

更复杂一点的场景，有两个数据流并行处理
快照制作的开始

Source 收到 JM 发送的 Checkpoin ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/26/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL2%EF%BC%9A%E6%B5%81-%E6%89%B9-OLAP-%E4%B8%80%E4%BD%93%E7%9A%84-Flink-%E5%BC%95%E6%93%8E%E4%BB%8B%E7%BB%8D/" title="『字节青训营-4th』L2：流/批/OLAP 一体的 Flink 引擎介绍">『字节青训营-4th』L2：流/批/OLAP 一体的 Flink 引擎介绍</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-07-26T09:39:39.000Z" title="发表于 2022-07-26 17:39:39">2022-07-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="content">相关链接🎶 学员手册：【大数据专场 学习资料一】第四届字节跳动青训营 - 掘金

Flink 概述
Apache Flink 的诞生背景
什么是大数据

大数据计算架构发展历史

Hadoop 那里就是谷歌发的 3 篇论文，GFS， Map-Reduce 等
为什么需要流式计算


简单地说，就是业内需要流式计算，然后就有了 Flink
为什么 Apache Flink 会脱颖而出
流式计算引擎发展历程

流式计算引擎对比


At Least Once ：能保证数据至少能被处理一次
At Most Once ：数据最多被处理一次（可能没处理到）

StateFul：不再依赖外部系统存储状态
Why Flink

牛啤一体可还行（
Apache Flink 开源生态

最左边：Flink 可以高性能地使用很多存储引擎
中间框：内部架构设计，下面会说
下面：部署模式
上面：基于 Flink 的其他框架
Flink 整体架构
Flink 分层架构

最上面： SDK

SQL 相关 API
Stream 相关 API
python 的 API

中间：执行引擎层
Flink 总体架构

 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/4/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/#content-inner">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/#content-inner">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/#content-inner">17</a><a class="extend next" rel="next" href="/page/6/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/static/favicon.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Nick Xu</div><div class="author-info__description">这家伙真勤奋，什么都留下了</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">259</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">53</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">36</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/NX-Official"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="tencent://message/?uin=976180942&amp;Site=tool.520101.com&amp;Menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="/static/weixin.jpg" target="_blank" title="微信"><i class="fab fa-weixin"></i></a><a class="social-icon" href="mailto:976180942@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/rss2.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/01/%E5%86%99%E5%9C%A8%E5%A4%A7%E4%BA%8C%E5%BC%80%E5%AD%A6%E4%B9%8B%E5%88%9D/" title="写在大二下开学之初">写在大二下开学之初</a><time datetime="2023-03-05T14:36:19.346Z" title="更新于 2023-03-05 22:36:19">2023-03-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/05/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85Docker/" title="服务器离线安装Docker">服务器离线安装Docker</a><time datetime="2023-03-05T14:35:39.199Z" title="更新于 2023-03-05 22:35:39">2023-03-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/05/ChatGPT%E5%AF%B9%E8%AF%9D%E8%AE%B0%E5%BD%95%EF%BC%88%E5%9B%9B%EF%BC%89%EF%BC%9A%E6%89%8B%E5%8A%A8%E9%80%92%E5%BD%92%E4%B8%8B%E8%BD%BD%E4%BE%9D%E8%B5%96%E7%9A%84%E9%BA%BB%E7%83%A6/" title="ChatGPT对话记录（四）：手动递归下载依赖的麻烦">ChatGPT对话记录（四）：手动递归下载依赖的麻烦</a><time datetime="2023-03-05T14:24:34.743Z" title="更新于 2023-03-05 22:24:34">2023-03-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/12/10/%E8%AE%BE%E7%BD%AE%E5%9C%A8%E4%BD%BF%E7%94%A8-SSH-key-%E6%97%B6%E4%B8%8D%E7%94%A8%E5%86%8D%E8%BE%93%E5%85%A5%E5%AF%86%E7%A0%81/" title="设置在使用 SSH key 时不用再输入密码">设置在使用 SSH key 时不用再输入密码</a><time datetime="2023-02-18T16:18:45.589Z" title="更新于 2023-02-19 00:18:45">2023-02-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/02/19/ChatGPT%E5%AF%B9%E8%AF%9D%E8%AE%B0%E5%BD%95%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AGORM%E7%9A%84%E8%A1%8C%E7%BA%A7%E9%94%81/" title="ChatGPT对话记录（三）：GORM的行级锁">ChatGPT对话记录（三）：GORM的行级锁</a><time datetime="2023-02-18T16:17:57.875Z" title="更新于 2023-02-19 00:17:57">2023-02-19</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/C-C/"><span class="card-category-list-name">C / C++</span><span class="card-category-list-count">13</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/ChatGPT-%E5%AF%B9%E8%AF%9D%E8%AE%B0%E5%BD%95/"><span class="card-category-list-name">ChatGPT 对话记录</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Go/"><span class="card-category-list-name">Go</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Golang/"><span class="card-category-list-name">Golang</span><span class="card-category-list-count">46</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Golang/Flamego-%E6%A1%86%E6%9E%B6/"><span class="card-category-list-name">Flamego 框架</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Golang/GORM-%E6%A1%86%E6%9E%B6/"><span class="card-category-list-name">GORM 框架</span><span class="card-category-list-count">12</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Golang/Gin-%E6%A1%86%E6%9E%B6/"><span class="card-category-list-name">Gin 框架</span><span class="card-category-list-count">10</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Golang/go-zero-%E6%A1%86%E6%9E%B6/"><span class="card-category-list-name">go-zero 框架</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Golang/%E8%AF%AD%E6%B3%95%E9%80%9F%E9%80%9A/"><span class="card-category-list-name">语法速通</span><span class="card-category-list-count">12</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Hexo-Butterfly-%E5%BB%BA%E7%AB%99%E6%8C%87%E5%8D%97/"><span class="card-category-list-name">Hexo + Butterfly 建站指南</span><span class="card-category-list-count">10</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Others/"><span class="card-category-list-name">Others</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python/"><span class="card-category-list-name">Python</span><span class="card-category-list-count">14</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python/Python3-%E5%85%A5%E9%97%A8/"><span class="card-category-list-name">Python3 入门</span><span class="card-category-list-count">13</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E8%AF%BE%E5%A4%8D%E4%B9%A0/"><span class="card-category-list-name">基础课复习</span><span class="card-category-list-count">15</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E8%AF%BE%E5%A4%8D%E4%B9%A0/%E5%A4%A7%E5%AD%A6%E7%89%A9%E7%90%86/"><span class="card-category-list-name">大学物理</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E8%AF%BE%E5%A4%8D%E4%B9%A0/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/"><span class="card-category-list-name">离散数学</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E8%AF%BE%E5%A4%8D%E4%B9%A0/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/"><span class="card-category-list-name">高等数学</span><span class="card-category-list-count">4</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"><span class="card-category-list-name">微信小程序</span><span class="card-category-list-count">8</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/"><span class="card-category-list-name">开发基础</span><span class="card-category-list-count">8</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="card-category-list-name">数据库</span><span class="card-category-list-count">23</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/"><span class="card-category-list-name">MySQL</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/SQL-%E5%85%A5%E9%97%A8/"><span class="card-category-list-name">SQL 入门</span><span class="card-category-list-count">19</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"><span class="card-category-list-name">数据结构与算法</span><span class="card-category-list-count">18</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E6%8B%BE%E9%81%97/"><span class="card-category-list-name">算法拾遗</span><span class="card-category-list-count">12</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E6%8B%BE%E9%81%97/%E6%90%9C%E7%B4%A2%E6%8A%80%E6%9C%AF/"><span class="card-category-list-name">搜索技术</span><span class="card-category-list-count">9</span></a></li></ul></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%96%B0%E6%8A%80%E8%83%BD-Got/"><span class="card-category-list-name">新技能 Got</span><span class="card-category-list-count">21</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%A0%91%E8%8E%93%E6%B4%BE/"><span class="card-category-list-name">树莓派</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%BF%90%E7%BB%B4/"><span class="card-category-list-name">运维</span><span class="card-category-list-count">5</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%BF%90%E7%BB%B4/CICD/"><span class="card-category-list-name">CICD</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%BF%90%E7%BB%B4/Docker/"><span class="card-category-list-name">Docker</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E9%9A%8F%E7%AC%94%E4%B8%8E%E6%80%BB%E7%BB%93/"><span class="card-category-list-name">随笔与总结</span><span class="card-category-list-count">13</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/"><span class="card-category-list-name">青训营</span><span class="card-category-list-count">43</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-3rd-%E5%90%8E%E7%AB%AF/"><span class="card-category-list-name">字节跳动-3rd-后端</span><span class="card-category-list-count">23</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/"><span class="card-category-list-name">字节跳动-4th-大数据</span><span class="card-category-list-count">20</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E9%9D%A2%E8%AF%95%E5%85%AB%E8%82%A1%E6%96%87/"><span class="card-category-list-name">面试八股文</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E9%A2%98%E8%A7%A3/"><span class="card-category-list-name">题解</span><span class="card-category-list-count">4</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/ChatGPT/" style="font-size: 1.22em; color: rgb(45, 146, 191)">ChatGPT</a><a href="/tags/Linux/" style="font-size: 1.32em; color: rgb(164, 12, 12)">Linux</a><a href="/tags/SSH/" style="font-size: 1.2em; color: rgb(14, 5, 113)">SSH</a><a href="/tags/GORM/" style="font-size: 1.32em; color: rgb(16, 187, 43)">GORM</a><a href="/tags/Go/" style="font-size: 1.45em; color: rgb(12, 76, 192)">Go</a><a href="/tags/Gin/" style="font-size: 1.27em; color: rgb(196, 16, 195)">Gin</a><a href="/tags/%E5%BB%BA%E7%AB%99%E6%8A%80%E5%B7%A7/" style="font-size: 1.27em; color: rgb(144, 113, 107)">建站技巧</a><a href="/tags/Minecraft/" style="font-size: 1.17em; color: rgb(168, 67, 86)">Minecraft</a><a href="/tags/MySQL/" style="font-size: 1.22em; color: rgb(109, 139, 38)">MySQL</a><a href="/tags/Python/" style="font-size: 1.35em; color: rgb(166, 188, 195)">Python</a><a href="/tags/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" style="font-size: 1.2em; color: rgb(114, 35, 178)">环境配置</a><a href="/tags/SQL/" style="font-size: 1.38em; color: rgb(197, 145, 173)">SQL</a><a href="/tags/C-C/" style="font-size: 1.4em; color: rgb(13, 183, 84)">C/C++</a><a href="/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/" style="font-size: 1.3em; color: rgb(49, 89, 72)">算法竞赛</a><a href="/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/" style="font-size: 1.22em; color: rgb(36, 75, 144)">树莓派</a><a href="/tags/%E9%A2%98%E8%A7%A3/" style="font-size: 1.22em; color: rgb(43, 93, 112)">题解</a><a href="/tags/Makefile/" style="font-size: 1.15em; color: rgb(79, 48, 22)">Makefile</a><a href="/tags/CMake/" style="font-size: 1.15em; color: rgb(24, 182, 82)">CMake</a><a href="/tags/STL/" style="font-size: 1.17em; color: rgb(103, 77, 98)">STL</a><a href="/tags/GitHub-Actions/" style="font-size: 1.2em; color: rgb(100, 127, 13)">GitHub Actions</a><a href="/tags/CICD/" style="font-size: 1.2em; color: rgb(89, 0, 19)">CICD</a><a href="/tags/Docker/" style="font-size: 1.17em; color: rgb(174, 142, 171)">Docker</a><a href="/tags/GitHub/" style="font-size: 1.15em; color: rgb(64, 167, 106)">GitHub</a><a href="/tags/Webhook/" style="font-size: 1.15em; color: rgb(64, 81, 134)">Webhook</a><a href="/tags/grpc/" style="font-size: 1.17em; color: rgb(68, 190, 70)">grpc</a><a href="/tags/Redis/" style="font-size: 1.17em; color: rgb(60, 114, 33)">Redis</a><a href="/tags/go-zero/" style="font-size: 1.17em; color: rgb(50, 29, 3)">go-zero</a><a href="/tags/tus/" style="font-size: 1.15em; color: rgb(73, 95, 188)">tus</a><a href="/tags/Flamego/" style="font-size: 1.15em; color: rgb(117, 114, 163)">Flamego</a><a href="/tags/JWT/" style="font-size: 1.15em; color: rgb(108, 181, 37)">JWT</a><a href="/tags/%E8%BF%90%E7%BB%B4/" style="font-size: 1.15em; color: rgb(33, 194, 16)">运维</a><a href="/tags/Windows/" style="font-size: 1.17em; color: rgb(50, 192, 90)">Windows</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD/" style="font-size: 1.17em; color: rgb(123, 15, 27)">数据备份</a><a href="/tags/%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5/" style="font-size: 1.42em; color: rgb(68, 191, 60)">字节青训营</a><a href="/tags/Others/" style="font-size: 1.2em; color: rgb(148, 191, 90)">Others</a><a href="/tags/Twikoo/" style="font-size: 1.15em; color: rgb(143, 66, 63)">Twikoo</a><a href="/tags/WSL/" style="font-size: 1.2em; color: rgb(182, 188, 63)">WSL</a><a href="/tags/Clash/" style="font-size: 1.15em; color: rgb(163, 69, 40)">Clash</a><a href="/tags/k8s/" style="font-size: 1.15em; color: rgb(32, 137, 63)">k8s</a><a href="/tags/hduhelp/" style="font-size: 1.17em; color: rgb(49, 14, 31)">hduhelp</a><a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 1.27em; color: rgb(75, 63, 112)">随笔</a><a href="/tags/BFS/" style="font-size: 1.22em; color: rgb(33, 144, 45)">BFS</a><a href="/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/" style="font-size: 1.15em; color: rgb(6, 180, 72)">位运算</a><a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 1.15em; color: rgb(75, 149, 37)">数学</a><a href="/tags/DFS/" style="font-size: 1.15em; color: rgb(93, 19, 123)">DFS</a><a href="/tags/IDA/" style="font-size: 1.15em; color: rgb(112, 26, 91)">IDA*</a><a href="/tags/%E8%88%9E%E8%B9%88%E9%93%BE-DLX/" style="font-size: 1.15em; color: rgb(165, 127, 73)">舞蹈链/DLX</a><a href="/tags/IDDFS/" style="font-size: 1.15em; color: rgb(102, 191, 77)">IDDFS</a><a href="/tags/%E6%8E%92%E5%88%97%E7%BB%84%E5%90%88/" style="font-size: 1.15em; color: rgb(79, 23, 84)">排列组合</a><a href="/tags/618%E5%A5%BD%E7%89%A9/" style="font-size: 1.15em; color: rgb(137, 79, 174)">618好物</a><a href="/tags/%E9%9D%A2%E8%AF%95%E5%B7%A5%E4%BD%9C/" style="font-size: 1.15em; color: rgb(45, 172, 188)">面试工作</a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 1.17em; color: rgb(160, 184, 199)">面试</a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 1.25em; color: rgb(74, 80, 62)">微信小程序</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/02/"><span class="card-archive-list-date">二月 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">一月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/12/"><span class="card-archive-list-date">十二月 2022</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/11/"><span class="card-archive-list-date">十一月 2022</span><span class="card-archive-list-count">9</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/10/"><span class="card-archive-list-date">十月 2022</span><span class="card-archive-list-count">18</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/09/"><span class="card-archive-list-date">九月 2022</span><span class="card-archive-list-count">17</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/08/"><span class="card-archive-list-date">八月 2022</span><span class="card-archive-list-count">16</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">259</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2021-11-12T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">230.7k</div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-03-06T02:01:47.257Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background: #0d0d0d"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Nick Xu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/pluginsSrc/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#subtitle", {
      strings: ["求知若饥&#44;虚心若愚","Stay hungry, stay foolish"],
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = '求知若饥&#44;虚心若愚'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('/pluginsSrc/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo.nickxu.top/',
        region: 'ap-shanghai',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 1/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('/pluginsSrc/twikoo/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script defer="defer" id="ribbon" src="/pluginsSrc/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script></div><!-- hexo injector body_end start --><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>